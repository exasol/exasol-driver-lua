<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="990px" preserveAspectRatio="none" style="width:1131px;height:990px;background:#FFFFFF;" version="1.1" viewBox="0 0 1131 990" width="1131px" zoomAndPan="magnify"><defs/><g><rect height="30.4883" style="stroke:#00000000;stroke-width:1.0;fill:none;" width="254" x="440.25" y="10"/><text fill="#000000" font-family="Calibri" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="240" x="447.25" y="30.5352">Closing the Database Connection</text><rect fill="#DDDDDD" height="930.0078" style="stroke:#181818;stroke-width:0.5;" width="850.5" x="109" y="47.4883"/><text fill="#000000" font-family="Calibri" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="141" x="463.75" y="62.0566">Exasol Driver for Lua</text><rect fill="#FFFFFF" height="841.7207" style="stroke:#181818;stroke-width:1.0;" width="10" x="49" y="132.7754"/><rect fill="#FFFFFF" height="832.7207" style="stroke:#181818;stroke-width:1.0;" width="10" x="174.5" y="132.7754"/><rect fill="#FFFFFF" height="811.7207" style="stroke:#181818;stroke-width:1.0;" width="10" x="313.5" y="132.7754"/><rect fill="#FFFFFF" height="417.2363" style="stroke:#181818;stroke-width:1.0;" width="10" x="432.5" y="132.7754"/><rect fill="#FFFFFF" height="797.7207" style="stroke:#181818;stroke-width:1.0;" width="10" x="571" y="132.7754"/><rect fill="#FFFFFF" height="783.7207" style="stroke:#181818;stroke-width:1.0;" width="10" x="725" y="132.7754"/><rect fill="#FFFFFF" height="748.7207" style="stroke:#181818;stroke-width:1.0;" width="10" x="872.5" y="132.7754"/><rect fill="#FFFFFF" height="841.7207" style="stroke:#181818;stroke-width:1.0;" width="10" x="1025.5" y="132.7754"/><rect height="779.4102" style="stroke:#000000;stroke-width:1.5;fill:none;" width="1022.5" x="103" y="173.0859"/><rect height="321.3496" style="stroke:#000000;stroke-width:1.5;fill:none;" width="869.5" x="246" y="236.6621"/><rect height="236.7734" style="stroke:#000000;stroke-width:1.5;fill:none;" width="724.5" x="381" y="300.2383"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="54" x2="54" y1="122.7754" y2="983.4961"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="179" x2="179" y1="122.7754" y2="983.4961"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="318" x2="318" y1="122.7754" y2="983.4961"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="437" x2="437" y1="122.7754" y2="983.4961"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="576" x2="576" y1="122.7754" y2="983.4961"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="729.5" x2="729.5" y1="122.7754" y2="983.4961"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="877.5" x2="877.5" y1="122.7754" y2="983.4961"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1030.5" x2="1030.5" y1="122.7754" y2="983.4961"/><rect fill="#E2E2F0" height="50.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="5" y="70.7988"/><text fill="#000000" font-family="Calibri" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="71" x="18.5" y="93.334">«external»</text><text fill="#000000" font-family="Calibri" font-size="14" lengthAdjust="spacing" textLength="80" x="14" y="109.8223">Client Code</text><rect fill="#E2E2F0" height="36" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="133" x="113" y="85.7754"/><ellipse cx="131" cy="103.7754" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M133.4731,109.9185 Q132.8921,110.2173 132.2529,110.3667 Q131.6138,110.5161 130.9082,110.5161 Q128.4014,110.5161 127.0815,108.8643 Q125.7617,107.2124 125.7617,104.0913 Q125.7617,100.9619 127.0815,99.3101 Q128.4014,97.6582 130.9082,97.6582 Q131.6138,97.6582 132.2612,97.8076 Q132.9087,97.957 133.4731,98.2559 L133.4731,100.9785 Q132.8423,100.3975 132.2488,100.1277 Q131.6553,99.8579 131.0244,99.8579 Q129.6797,99.8579 128.9949,100.9246 Q128.3101,101.9912 128.3101,104.0913 Q128.3101,106.1831 128.9949,107.2498 Q129.6797,108.3164 131.0244,108.3164 Q131.6553,108.3164 132.2488,108.0466 Q132.8423,107.7769 133.4731,107.1958 Z " fill="#000000"/><text fill="#000000" font-family="Calibri" font-size="14" lengthAdjust="spacing" textLength="87" x="150" y="108.3105">Environment</text><rect fill="#E2E2F0" height="36" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="125" x="256" y="85.7754"/><ellipse cx="274" cy="103.7754" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M276.4731,109.9185 Q275.8921,110.2173 275.2529,110.3667 Q274.6138,110.5161 273.9082,110.5161 Q271.4014,110.5161 270.0815,108.8643 Q268.7617,107.2124 268.7617,104.0913 Q268.7617,100.9619 270.0815,99.3101 Q271.4014,97.6582 273.9082,97.6582 Q274.6138,97.6582 275.2612,97.8076 Q275.9087,97.957 276.4731,98.2559 L276.4731,100.9785 Q275.8423,100.3975 275.2488,100.1277 Q274.6553,99.8579 274.0244,99.8579 Q272.6797,99.8579 271.9949,100.9246 Q271.3101,101.9912 271.3101,104.0913 Q271.3101,106.1831 271.9949,107.2498 Q272.6797,108.3164 274.0244,108.3164 Q274.6553,108.3164 275.2488,108.0466 Q275.8423,107.7769 276.4731,107.1958 Z " fill="#000000"/><text fill="#000000" font-family="Calibri" font-size="14" lengthAdjust="spacing" textLength="79" x="293" y="108.3105">Connection</text><rect fill="#E2E2F0" height="36" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="93" x="391" y="85.7754"/><ellipse cx="409" cy="103.7754" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M411.4731,109.9185 Q410.8921,110.2173 410.2529,110.3667 Q409.6138,110.5161 408.9082,110.5161 Q406.4014,110.5161 405.0815,108.8643 Q403.7617,107.2124 403.7617,104.0913 Q403.7617,100.9619 405.0815,99.3101 Q406.4014,97.6582 408.9082,97.6582 Q409.6138,97.6582 410.2612,97.8076 Q410.9087,97.957 411.4731,98.2559 L411.4731,100.9785 Q410.8423,100.3975 410.2488,100.1277 Q409.6553,99.8579 409.0244,99.8579 Q407.6797,99.8579 406.9949,100.9246 Q406.3101,101.9912 406.3101,104.0913 Q406.3101,106.1831 406.9949,107.2498 Q407.6797,108.3164 409.0244,108.3164 Q409.6553,108.3164 410.2488,108.0466 Q410.8423,107.7769 411.4731,107.1958 Z " fill="#000000"/><text fill="#000000" font-family="Calibri" font-size="14" lengthAdjust="spacing" textLength="47" x="428" y="108.3105">Cursor</text><rect fill="#E2E2F0" height="36" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="164" x="494" y="85.7754"/><ellipse cx="512" cy="103.7754" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M514.4731,109.9185 Q513.8921,110.2173 513.2529,110.3667 Q512.6138,110.5161 511.9082,110.5161 Q509.4014,110.5161 508.0815,108.8643 Q506.7617,107.2124 506.7617,104.0913 Q506.7617,100.9619 508.0815,99.3101 Q509.4014,97.6582 511.9082,97.6582 Q512.6138,97.6582 513.2612,97.8076 Q513.9087,97.957 514.4731,98.2559 L514.4731,100.9785 Q513.8423,100.3975 513.2488,100.1277 Q512.6553,99.8579 512.0244,99.8579 Q510.6797,99.8579 509.9949,100.9246 Q509.3101,101.9912 509.3101,104.0913 Q509.3101,106.1831 509.9949,107.2498 Q510.6797,108.3164 512.0244,108.3164 Q512.6553,108.3164 513.2488,108.0466 Q513.8423,107.7769 514.4731,107.1958 Z " fill="#000000"/><text fill="#000000" font-family="Calibri" font-size="14" lengthAdjust="spacing" textLength="118" x="531" y="108.3105">ExasolWebsocket</text><rect fill="#E2E2F0" height="36" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="119" x="670.5" y="85.7754"/><ellipse cx="688.5" cy="103.7754" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M690.9731,109.9185 Q690.3921,110.2173 689.7529,110.3667 Q689.1138,110.5161 688.4082,110.5161 Q685.9014,110.5161 684.5815,108.8643 Q683.2617,107.2124 683.2617,104.0913 Q683.2617,100.9619 684.5815,99.3101 Q685.9014,97.6582 688.4082,97.6582 Q689.1138,97.6582 689.7612,97.8076 Q690.4087,97.957 690.9731,98.2559 L690.9731,100.9785 Q690.3423,100.3975 689.7488,100.1277 Q689.1553,99.8579 688.5244,99.8579 Q687.1797,99.8579 686.4949,100.9246 Q685.8101,101.9912 685.8101,104.0913 Q685.8101,106.1831 686.4949,107.2498 Q687.1797,108.3164 688.5244,108.3164 Q689.1553,108.3164 689.7488,108.0466 Q690.3423,107.7769 690.9731,107.1958 Z " fill="#000000"/><text fill="#000000" font-family="Calibri" font-size="14" lengthAdjust="spacing" textLength="73" x="707.5" y="108.3105">Websocket</text><rect fill="#E2E2F0" height="50.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="156" x="799.5" y="70.7988"/><text fill="#000000" font-family="Calibri" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="138" x="808.5" y="93.334">«Third party library»</text><text fill="#000000" font-family="Calibri" font-size="14" lengthAdjust="spacing" textLength="85" x="835" y="109.8223">LuWS Socket</text><rect fill="#E2E2F0" height="34.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="130" x="965.5" y="87.2871"/><text fill="#000000" font-family="Calibri" font-size="14" lengthAdjust="spacing" textLength="112" x="974.5" y="109.8223">Exasol Database</text><rect fill="#FFFFFF" height="841.7207" style="stroke:#181818;stroke-width:1.0;" width="10" x="49" y="132.7754"/><rect fill="#FFFFFF" height="832.7207" style="stroke:#181818;stroke-width:1.0;" width="10" x="174.5" y="132.7754"/><rect fill="#FFFFFF" height="811.7207" style="stroke:#181818;stroke-width:1.0;" width="10" x="313.5" y="132.7754"/><rect fill="#FFFFFF" height="417.2363" style="stroke:#181818;stroke-width:1.0;" width="10" x="432.5" y="132.7754"/><rect fill="#FFFFFF" height="797.7207" style="stroke:#181818;stroke-width:1.0;" width="10" x="571" y="132.7754"/><rect fill="#FFFFFF" height="783.7207" style="stroke:#181818;stroke-width:1.0;" width="10" x="725" y="132.7754"/><rect fill="#FFFFFF" height="748.7207" style="stroke:#181818;stroke-width:1.0;" width="10" x="872.5" y="132.7754"/><rect fill="#FFFFFF" height="841.7207" style="stroke:#181818;stroke-width:1.0;" width="10" x="1025.5" y="132.7754"/><polygon fill="#181818" points="162.5,154.0859,172.5,158.0859,162.5,162.0859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="59" x2="168.5" y1="158.0859" y2="158.0859"/><text fill="#000000" font-family="Calibri" font-size="13" lengthAdjust="spacing" textLength="41" x="68" y="151.3438">close()</text><path d="M103,173.0859 L181,173.0859 L181,184.3965 L171,194.3965 L103,194.3965 L103,173.0859 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="779.4102" style="stroke:#000000;stroke-width:1.5;" width="1022.5" x="103" y="173.0859"/><text fill="#000000" font-family="Calibri" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="120" y="188.6543">loop</text><text fill="#000000" font-family="Calibri" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="114" x="198" y="187.7207">[for all connections]</text><polygon fill="#181818" points="301.5,217.6621,311.5,221.6621,301.5,225.6621" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="184.5" x2="307.5" y1="221.6621" y2="221.6621"/><text fill="#000000" font-family="Calibri" font-size="13" lengthAdjust="spacing" textLength="41" x="193.5" y="214.9199">close()</text><path d="M246,236.6621 L324,236.6621 L324,247.9727 L314,257.9727 L246,257.9727 L246,236.6621 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="321.3496" style="stroke:#000000;stroke-width:1.5;" width="869.5" x="246" y="236.6621"/><text fill="#000000" font-family="Calibri" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="263" y="252.2305">loop</text><text fill="#000000" font-family="Calibri" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="89" x="341" y="251.2969">[for all cursors]</text><polygon fill="#181818" points="420.5,281.2383,430.5,285.2383,420.5,289.2383" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="323.5" x2="426.5" y1="285.2383" y2="285.2383"/><text fill="#000000" font-family="Calibri" font-size="13" lengthAdjust="spacing" textLength="41" x="332.5" y="278.4961">close()</text><path d="M381,300.2383 L447,300.2383 L447,311.5488 L437,321.5488 L381,321.5488 L381,300.2383 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="236.7734" style="stroke:#000000;stroke-width:1.5;" width="724.5" x="381" y="300.2383"/><text fill="#000000" font-family="Calibri" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="398" y="315.8066">alt</text><text fill="#000000" font-family="Calibri" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="70" x="464" y="314.873">[Cursor with</text><text fill="#000000" font-family="Calibri" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="52" x="464" y="327.8281">resultset]</text><polygon fill="#181818" points="559,373.0801,569,377.0801,559,381.0801" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="442.5" x2="565" y1="377.0801" y2="377.0801"/><text fill="#000000" font-family="Calibri" font-size="13" lengthAdjust="spacing" textLength="77" x="451.5" y="355.0273">send_close_</text><text fill="#000000" font-family="Calibri" font-size="13" lengthAdjust="spacing" textLength="63" x="451.5" y="370.3379">resultset()</text><polygon fill="#181818" points="713,406.3906,723,410.3906,713,414.3906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="581" x2="719" y1="410.3906" y2="410.3906"/><text fill="#000000" font-family="Calibri" font-size="13" lengthAdjust="spacing" textLength="116" x="590" y="403.6484">send_raw(payload)</text><polygon fill="#181818" points="860.5,455.0117,870.5,459.0117,860.5,463.0117" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="735" x2="866.5" y1="459.0117" y2="459.0117"/><text fill="#000000" font-family="Calibri" font-size="13" lengthAdjust="spacing" textLength="97" x="744" y="436.959">wssend(socket,</text><text fill="#000000" font-family="Calibri" font-size="13" lengthAdjust="spacing" textLength="53" x="744" y="452.2695">payload)</text><polygon fill="#181818" points="1013.5,469.0117,1023.5,473.0117,1013.5,477.0117" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="882.5" x2="1019.5" y1="473.0117" y2="473.0117"/><polygon fill="#181818" points="893.5,483.0117,883.5,487.0117,893.5,491.0117" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="887.5" x2="1024.5" y1="487.0117" y2="487.0117"/><polygon fill="#181818" points="746,497.0117,736,501.0117,746,505.0117" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="740" x2="871.5" y1="501.0117" y2="501.0117"/><polygon fill="#181818" points="592,511.0117,582,515.0117,592,519.0117" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="586" x2="724" y1="515.0117" y2="515.0117"/><polygon fill="#181818" points="453.5,525.0117,443.5,529.0117,453.5,533.0117" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="447.5" x2="570" y1="529.0117" y2="529.0117"/><polygon fill="#181818" points="334.5,546.0117,324.5,550.0117,334.5,554.0117" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="328.5" x2="436.5" y1="550.0117" y2="550.0117"/><line style="stroke:#A80036;stroke-width:2.0;" x1="428.5" x2="446.5" y1="541.0117" y2="559.0117"/><line style="stroke:#A80036;stroke-width:2.0;" x1="428.5" x2="446.5" y1="559.0117" y2="541.0117"/><polygon fill="#181818" points="559,586.3223,569,590.3223,559,594.3223" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="323.5" x2="565" y1="590.3223" y2="590.3223"/><text fill="#000000" font-family="Calibri" font-size="13" lengthAdjust="spacing" textLength="114" x="332.5" y="583.5801">send_disconnect()</text><polygon fill="#181818" points="713,619.6328,723,623.6328,713,627.6328" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="581" x2="719" y1="623.6328" y2="623.6328"/><text fill="#000000" font-family="Calibri" font-size="13" lengthAdjust="spacing" textLength="116" x="590" y="616.8906">send_raw(payload)</text><polygon fill="#181818" points="860.5,668.2539,870.5,672.2539,860.5,676.2539" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="735" x2="866.5" y1="672.2539" y2="672.2539"/><text fill="#000000" font-family="Calibri" font-size="13" lengthAdjust="spacing" textLength="97" x="744" y="650.2012">wssend(socket,</text><text fill="#000000" font-family="Calibri" font-size="13" lengthAdjust="spacing" textLength="53" x="744" y="665.5117">payload)</text><polygon fill="#181818" points="1013.5,682.2539,1023.5,686.2539,1013.5,690.2539" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="882.5" x2="1019.5" y1="686.2539" y2="686.2539"/><polygon fill="#181818" points="893.5,696.2539,883.5,700.2539,893.5,704.2539" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="887.5" x2="1024.5" y1="700.2539" y2="700.2539"/><polygon fill="#181818" points="746,710.2539,736,714.2539,746,718.2539" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="740" x2="871.5" y1="714.2539" y2="714.2539"/><polygon fill="#181818" points="592,724.2539,582,728.2539,592,732.2539" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="586" x2="724" y1="728.2539" y2="728.2539"/><polygon fill="#181818" points="334.5,738.2539,324.5,742.2539,334.5,746.2539" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="328.5" x2="570" y1="742.2539" y2="742.2539"/><polygon fill="#181818" points="559,771.5645,569,775.5645,559,779.5645" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="323.5" x2="565" y1="775.5645" y2="775.5645"/><text fill="#000000" font-family="Calibri" font-size="13" lengthAdjust="spacing" textLength="41" x="332.5" y="768.8223">close()</text><polygon fill="#181818" points="713,804.875,723,808.875,713,812.875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="581" x2="719" y1="808.875" y2="808.875"/><text fill="#000000" font-family="Calibri" font-size="13" lengthAdjust="spacing" textLength="41" x="590" y="802.1328">close()</text><polygon fill="#181818" points="860.5,838.1855,870.5,842.1855,860.5,846.1855" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="735" x2="866.5" y1="842.1855" y2="842.1855"/><text fill="#000000" font-family="Calibri" font-size="13" lengthAdjust="spacing" textLength="100" x="744" y="835.4434">wsclose(socket)</text><line style="stroke:#181818;stroke-width:1.0;" x1="882.5" x2="924.5" y1="875.4961" y2="875.4961"/><line style="stroke:#181818;stroke-width:1.0;" x1="924.5" x2="924.5" y1="875.4961" y2="888.4961"/><line style="stroke:#181818;stroke-width:1.0;" x1="883.5" x2="924.5" y1="888.4961" y2="888.4961"/><polygon fill="#181818" points="893.5,884.4961,883.5,888.4961,893.5,892.4961" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Calibri" font-size="13" lengthAdjust="spacing" textLength="81" x="891.5" y="868.7539">Close socket</text><line style="stroke:#A80036;stroke-width:2.0;" x1="868.5" x2="886.5" y1="879.4961" y2="897.4961"/><line style="stroke:#A80036;stroke-width:2.0;" x1="868.5" x2="886.5" y1="897.4961" y2="879.4961"/><polygon fill="#181818" points="746,898.4961,736,902.4961,746,906.4961" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="740" x2="876.5" y1="902.4961" y2="902.4961"/><polygon fill="#181818" points="592,912.4961,582,916.4961,592,920.4961" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="586" x2="729" y1="916.4961" y2="916.4961"/><line style="stroke:#A80036;stroke-width:2.0;" x1="721" x2="739" y1="907.4961" y2="925.4961"/><line style="stroke:#A80036;stroke-width:2.0;" x1="721" x2="739" y1="925.4961" y2="907.4961"/><polygon fill="#181818" points="334.5,926.4961,324.5,930.4961,334.5,934.4961" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="328.5" x2="575" y1="930.4961" y2="930.4961"/><line style="stroke:#A80036;stroke-width:2.0;" x1="567" x2="585" y1="921.4961" y2="939.4961"/><line style="stroke:#A80036;stroke-width:2.0;" x1="567" x2="585" y1="939.4961" y2="921.4961"/><polygon fill="#181818" points="195.5,940.4961,185.5,944.4961,195.5,948.4961" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="189.5" x2="317.5" y1="944.4961" y2="944.4961"/><line style="stroke:#A80036;stroke-width:2.0;" x1="309.5" x2="327.5" y1="935.4961" y2="953.4961"/><line style="stroke:#A80036;stroke-width:2.0;" x1="309.5" x2="327.5" y1="953.4961" y2="935.4961"/><polygon fill="#181818" points="70,961.4961,60,965.4961,70,969.4961" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="64" x2="178.5" y1="965.4961" y2="965.4961"/><line style="stroke:#A80036;stroke-width:2.0;" x1="170.5" x2="188.5" y1="956.4961" y2="974.4961"/><line style="stroke:#A80036;stroke-width:2.0;" x1="170.5" x2="188.5" y1="974.4961" y2="956.4961"/><!--MD5=[950d42520631540791d1afc807a5b47d]
@startuml seq_close
!include ../clean.skin

title: Closing the Database Connection

participant "Client Code" as client <<external>>
box "Exasol Driver for Lua"
    participant Environment as env << (C,#ADD1B2) >>
    participant Connection as conn << (C,#ADD1B2) >>
    participant Cursor as cur << (C,#ADD1B2) >>
    participant ExasolWebsocket as exaws << (C,#ADD1B2) >>
    participant Websocket as ws << (C,#ADD1B2) >>
    participant "LuWS Socket" as luws <<Third party library>>
end box
participant "Exasol Database" as db

activate client
activate env
activate conn
activate cur
activate exaws
activate ws
activate luws
activate db

client -> env : close()
loop for all connections
    env -> conn : close()
    loop for all cursors
        conn -> cur : close()
        alt Cursor with\nresultset
            cur -> exaws : send_close_\nresultset()
            exaws -> ws : send_raw(payload)
            ws -> luws : wssend(socket,\npayload)
            luws -> db
            db - -> luws
            luws - -> ws
            ws - -> exaws
            exaws - -> cur
        end
        cur - -> conn
        destroy cur
    end
    conn -> exaws : send_disconnect()
    exaws -> ws : send_raw(payload)
    ws -> luws : wssend(socket,\npayload)
    luws -> db
    db - -> luws
    luws - -> ws
    ws - -> exaws
    exaws - -> conn
    conn -> exaws : close()
    exaws -> ws : close()
    ws -> luws : wsclose(socket)
    luws -> luws : Close socket
    destroy luws
    luws - -> ws
    ws - -> exaws
    destroy ws
    exaws - -> conn
    destroy exaws
    conn - -> env
    destroy conn
end
env - -> client
destroy env

@enduml

@startuml seq_close
hide empty methods
hide empty attributes
skinparam style strictuml
skinparam classAttributeIconSize 0
!pragma horizontalLineBetweenDifferentPackageAllowed

skinparam defaultFontName Calibri

skinparam padding 2

title: Closing the Database Connection

participant "Client Code" as client <<external>>
box "Exasol Driver for Lua"
    participant Environment as env << (C,#ADD1B2) >>
    participant Connection as conn << (C,#ADD1B2) >>
    participant Cursor as cur << (C,#ADD1B2) >>
    participant ExasolWebsocket as exaws << (C,#ADD1B2) >>
    participant Websocket as ws << (C,#ADD1B2) >>
    participant "LuWS Socket" as luws <<Third party library>>
end box
participant "Exasol Database" as db

activate client
activate env
activate conn
activate cur
activate exaws
activate ws
activate luws
activate db

client -> env : close()
loop for all connections
    env -> conn : close()
    loop for all cursors
        conn -> cur : close()
        alt Cursor with\nresultset
            cur -> exaws : send_close_\nresultset()
            exaws -> ws : send_raw(payload)
            ws -> luws : wssend(socket,\npayload)
            luws -> db
            db - -> luws
            luws - -> ws
            ws - -> exaws
            exaws - -> cur
        end
        cur - -> conn
        destroy cur
    end
    conn -> exaws : send_disconnect()
    exaws -> ws : send_raw(payload)
    ws -> luws : wssend(socket,\npayload)
    luws -> db
    db - -> luws
    luws - -> ws
    ws - -> exaws
    exaws - -> conn
    conn -> exaws : close()
    exaws -> ws : close()
    ws -> luws : wsclose(socket)
    luws -> luws : Close socket
    destroy luws
    luws - -> ws
    ws - -> exaws
    destroy ws
    exaws - -> conn
    destroy exaws
    conn - -> env
    destroy conn
end
env - -> client
destroy env

@enduml

PlantUML version 1.2022.2(Sat Mar 05 17:30:19 CET 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: DE
--></g></svg>