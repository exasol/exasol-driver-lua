<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="353px" preserveAspectRatio="none" style="width:542px;height:353px;background:#FFFFFF;" version="1.1" viewBox="0 0 542 353" width="542px" zoomAndPan="magnify"><defs/><g><rect fill="#DDDDDD" height="334.3496" style="stroke:#181818;stroke-width:0.5;" width="276" x="124" y="6"/><text fill="#000000" font-family="Calibri" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="141" x="191.5" y="20.5684">Exasol Driver for Lua</text><rect fill="#FFFFFF" height="261.0391" style="stroke:#181818;stroke-width:1.0;" width="10" x="64" y="76.3105"/><rect fill="#FFFFFF" height="219.7285" style="stroke:#181818;stroke-width:1.0;" width="10" x="189.5" y="101.6211"/><rect fill="#FFFFFF" height="33.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="328.5" y="165.1973"/><rect fill="#FFFFFF" height="261.0391" style="stroke:#181818;stroke-width:1.0;" width="10" x="466" y="76.3105"/><rect height="89.8867" style="stroke:#000000;stroke-width:1.5;fill:none;" width="288" x="118" y="116.6211"/><rect height="108.8418" style="stroke:#000000;stroke-width:1.5;fill:none;" width="303" x="10" y="220.5078"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="69" x2="69" y1="66.3105" y2="346.3496"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="194" x2="194" y1="66.3105" y2="346.3496"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="333" x2="333" y1="66.3105" y2="346.3496"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="471" x2="471" y1="66.3105" y2="346.3496"/><rect fill="#E2E2F0" height="50.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="20" y="14.334"/><text fill="#000000" font-family="Calibri" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="71" x="33.5" y="36.8691">«external»</text><text fill="#000000" font-family="Calibri" font-size="14" lengthAdjust="spacing" textLength="80" x="29" y="53.3574">Client Code</text><rect fill="#E2E2F0" height="36" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="133" x="128" y="29.3105"/><ellipse cx="146" cy="47.3105" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M148.4731,53.4536 Q147.8921,53.7524 147.2529,53.9019 Q146.6138,54.0513 145.9082,54.0513 Q143.4014,54.0513 142.0815,52.3994 Q140.7617,50.7476 140.7617,47.6265 Q140.7617,44.4971 142.0815,42.8452 Q143.4014,41.1934 145.9082,41.1934 Q146.6138,41.1934 147.2612,41.3428 Q147.9087,41.4922 148.4731,41.791 L148.4731,44.5137 Q147.8423,43.9326 147.2488,43.6628 Q146.6553,43.3931 146.0244,43.3931 Q144.6797,43.3931 143.9949,44.4597 Q143.3101,45.5264 143.3101,47.6265 Q143.3101,49.7183 143.9949,50.7849 Q144.6797,51.8516 146.0244,51.8516 Q146.6553,51.8516 147.2488,51.5818 Q147.8423,51.312 148.4731,50.731 Z " fill="#000000"/><text fill="#000000" font-family="Calibri" font-size="14" lengthAdjust="spacing" textLength="87" x="165" y="51.8457">Environment</text><rect fill="#E2E2F0" height="36" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="125" x="271" y="29.3105"/><ellipse cx="289" cy="47.3105" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M291.4731,53.4536 Q290.8921,53.7524 290.2529,53.9019 Q289.6138,54.0513 288.9082,54.0513 Q286.4014,54.0513 285.0815,52.3994 Q283.7617,50.7476 283.7617,47.6265 Q283.7617,44.4971 285.0815,42.8452 Q286.4014,41.1934 288.9082,41.1934 Q289.6138,41.1934 290.2612,41.3428 Q290.9087,41.4922 291.4731,41.791 L291.4731,44.5137 Q290.8423,43.9326 290.2488,43.6628 Q289.6553,43.3931 289.0244,43.3931 Q287.6797,43.3931 286.9949,44.4597 Q286.3101,45.5264 286.3101,47.6265 Q286.3101,49.7183 286.9949,50.7849 Q287.6797,51.8516 289.0244,51.8516 Q289.6553,51.8516 290.2488,51.5818 Q290.8423,51.312 291.4731,50.731 Z " fill="#000000"/><text fill="#000000" font-family="Calibri" font-size="14" lengthAdjust="spacing" textLength="79" x="308" y="51.8457">Connection</text><rect fill="#E2E2F0" height="34.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="130" x="406" y="30.8223"/><text fill="#000000" font-family="Calibri" font-size="14" lengthAdjust="spacing" textLength="112" x="415" y="53.3574">Exasol Database</text><rect fill="#FFFFFF" height="261.0391" style="stroke:#181818;stroke-width:1.0;" width="10" x="64" y="76.3105"/><rect fill="#FFFFFF" height="219.7285" style="stroke:#181818;stroke-width:1.0;" width="10" x="189.5" y="101.6211"/><rect fill="#FFFFFF" height="33.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="328.5" y="165.1973"/><rect fill="#FFFFFF" height="261.0391" style="stroke:#181818;stroke-width:1.0;" width="10" x="466" y="76.3105"/><polygon fill="#181818" points="177.5,97.6211,187.5,101.6211,177.5,105.6211" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="74" x2="183.5" y1="101.6211" y2="101.6211"/><text fill="#000000" font-family="Calibri" font-size="13" lengthAdjust="spacing" textLength="41" x="83" y="94.8789">close()</text><path d="M118,116.6211 L196,116.6211 L196,127.9316 L186,137.9316 L118,137.9316 L118,116.6211 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="89.8867" style="stroke:#000000;stroke-width:1.5;" width="288" x="118" y="116.6211"/><text fill="#000000" font-family="Calibri" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="135" y="132.1895">loop</text><text fill="#000000" font-family="Calibri" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="114" x="213" y="131.2559">[for all connections]</text><polygon fill="#181818" points="316.5,161.1973,326.5,165.1973,316.5,169.1973" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="199.5" x2="322.5" y1="165.1973" y2="165.1973"/><text fill="#000000" font-family="Calibri" font-size="13" lengthAdjust="spacing" textLength="41" x="208.5" y="158.4551">closed</text><polygon fill="#181818" points="210.5,194.5078,200.5,198.5078,210.5,202.5078" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="204.5" x2="332.5" y1="198.5078" y2="198.5078"/><text fill="#000000" font-family="Calibri" font-size="13" lengthAdjust="spacing" textLength="56" x="218.5" y="191.7656">is closed</text><path d="M10,220.5078 L76,220.5078 L76,231.8184 L66,241.8184 L10,241.8184 L10,220.5078 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="108.8418" style="stroke:#000000;stroke-width:1.5;" width="303" x="10" y="220.5078"/><text fill="#000000" font-family="Calibri" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="27" y="236.0762">alt</text><text fill="#000000" font-family="Calibri" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="213" x="93" y="235.1426">[at least one connection is not closed]</text><polygon fill="#181818" points="85,265.084,75,269.084,85,273.084" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="79" x2="188.5" y1="269.084" y2="269.084"/><text fill="#000000" font-family="Calibri" font-size="13" lengthAdjust="spacing" textLength="30" x="93" y="262.3418">false</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="313" y1="278.084" y2="278.084"/><text fill="#000000" font-family="Calibri" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="154" x="17" y="290.7188">[all connections are closed]</text><polygon fill="#181818" points="85,317.3496,75,321.3496,85,325.3496" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="79" x2="193.5" y1="321.3496" y2="321.3496"/><text fill="#000000" font-family="Calibri" font-size="13" lengthAdjust="spacing" textLength="25" x="93" y="314.6074">true</text><line style="stroke:#A80036;stroke-width:2.0;" x1="185.5" x2="203.5" y1="312.3496" y2="330.3496"/><line style="stroke:#A80036;stroke-width:2.0;" x1="185.5" x2="203.5" y1="330.3496" y2="312.3496"/><!--MD5=[84bd9f0295a02de7dc871f7408dbbae6]
@startuml seq_environment_close
!include ../clean.skin

participant "Client Code" as client <<external>>
box "Exasol Driver for Lua"
    participant Environment as env << (C,#ADD1B2) >>
    participant Connection as conn << (C,#ADD1B2) >>
end box
participant "Exasol Database" as db

activate client
activate db

' [dsn -> req~luasql-environment-close~1 >> impl,itest]
client -> env : close()
activate env
loop for all connections
    env -> conn : closed
    activate conn
    conn - -> env: is closed
    deactivate conn
end
alt at least one connection is not closed
    env - -> client: false
else all connections are closed
    env - -> client: true
    destroy env
end

@enduml

@startuml seq_environment_close
hide empty methods
hide empty attributes
skinparam style strictuml
skinparam classAttributeIconSize 0
!pragma horizontalLineBetweenDifferentPackageAllowed

skinparam defaultFontName Calibri

skinparam padding 2

participant "Client Code" as client <<external>>
box "Exasol Driver for Lua"
    participant Environment as env << (C,#ADD1B2) >>
    participant Connection as conn << (C,#ADD1B2) >>
end box
participant "Exasol Database" as db

activate client
activate db

client -> env : close()
activate env
loop for all connections
    env -> conn : closed
    activate conn
    conn - -> env: is closed
    deactivate conn
end
alt at least one connection is not closed
    env - -> client: false
else all connections are closed
    env - -> client: true
    destroy env
end

@enduml

PlantUML version 1.2022.4(Sat Apr 09 15:29:17 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: DE
--></g></svg>